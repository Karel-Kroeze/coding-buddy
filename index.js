var e=require("vis"),t=e.Network,n=e.DataSet,r={physics:!1,height:"100%",width:"100%",nodes:{chosen:!1,shape:"box",labelHighlightBold:!1,shapeProperties:{borderRadius:0},borderWidth:1,borderWidthSelected:1,color:{border:"#6495ED",background:"#4444AD",highlight:"#6495ED",hover:"#6495ED"},font:{color:"white",size:15,face:'"Helvetica Neue", Helvetica, Arial, sans-serif'},widthConstraint:{minimum:25,maximum:150}},edges:{labelHighlightBold:!1,arrows:"to",width:1,color:{color:"black",highlight:"black",hover:"black"},font:{color:"black",size:15,face:'"Helvetica Neue", Helvetica, Arial, sans-serif',strokeWidth:8,strokeColor:"white",background:"white"},selectionWidth:0,smooth:!1,length:150}};function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,c,"next",e)}function c(e){a(i,r,o,s,c,"throw",e)}s(void 0)}))}}var c={enabled:!0,color:"rgb(99, 234, 255)",size:5,x:0,y:0},d={shadow:c,color:{border:"rgb(99, 234, 255)"},borderWidth:2},l={shadow:c,color:{color:"rgb(99, 234, 255)",highlight:"rgb(99, 234, 255)"},width:2};function u(e,t){return f.apply(this,arguments)}function f(){return(f=s(regeneratorRuntime.mark((function e(o,i){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new n(o.nodes);case 2:return a=e.sent,e.next=5,new n(o.edges);case 5:return s=e.sent,e.t0=a,e.t1=s,e.next=10,new t(i,{nodes:a,edges:s},r);case 10:return e.t2=e.sent,e.abrupt("return",{nodes:e.t0,edges:e.t1,network:e.t2});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t,n){var r=document.createRange().createContextualFragment(C);t.appendChild(r);var i=t.querySelector("#hint-target");!function(e,t){var n;switch(e.querySelector(".hint-message-text").innerHTML=t.message,e.querySelector("#hint-id").innerHTML=t.id,t.element_type){case"edge":case"node":case"missing_edge":n=m;break;default:n=v}e.querySelector(".hint-image").src=n.src,function(e,t){var n=e.querySelector("#hint-buttons");n.innerHTML="";var r,i=o(t.responses);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.append(x(a,t.response.message==a.message))}}catch(e){i.e(e)}finally{i.f()}}(e,t)}(i,e),n.on("afterDrawing",(function(){w(e,i,t,p(e,n,t,i),k(e),!0)})),setInterval((function(){return w(e,i,t,p(e,n,t,i),k(e),!0)}),500),w(e,i,t,p(e,n,t,i),k(e),!0),console.log({hint:e,pos:p(e,n,t,i),offset:k(e)}),b(e,n).forEach((function(e){n.body.nodes[e].setOptions(d)}));var a=function(e,t){if("edge"===e.element_type)return t.body.edges[e.element_id]}(e,n);a&&a.setOptions(l),document.addEventListener("keydown",(function(e){"Shift"==e.key&&(i.style.opacity="0.2")})),document.addEventListener("keyup",(function(e){"Shift"==e.key&&(i.style.opacity="1.0")}))}function g(e,t){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:r.left-n.left,y:r.top-n.top}}function y(e){var t=e.getBoundingClientRect();return{x:t.width,y:t.height}}document.addEventListener("DOMContentLoaded",s(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,s,c,d,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("artifact"),console.log("Feedback.ts version 1.1"),!t){e.next=29;break}return(n=document.createElement("div")).classList.add("before"),t.append(n),e.next=8,u(artifact.content.before.content,n);case 8:return r=e.sent,e.next=11,h(artifact.content.hint,n,r.network);case 11:if(!artifact.content.after){e.next=27;break}return(o=document.createElement("div")).classList.add("after","hidden"),i=document.createRange().createContextualFragment(L),a=i.querySelector("#buttonAfter"),s=i.querySelector("#buttonBefore"),t.append(o,i),e.next=20,u(artifact.content.after.content,o);case 20:c=e.sent,d=function(){n.classList.add("hidden"),o.classList.remove("hidden"),s.disabled=!1,a.disabled=!0,c.network.fit(),console.log("switch:after")},a.onclick=d,l=function(){n.classList.remove("hidden"),o.classList.add("hidden"),s.disabled=!0,a.disabled=!1,r.network.fit(),console.log("switch:before")},s.onclick=l,document.addEventListener("keydown",(function(e){console.log('Keydown: "'.concat(e.key,'"')),"ArrowLeft"!=e.key&&"b"!=e.key||(e.preventDefault(),l()),"ArrowRight"!=e.key&&"a"!=e.key||(e.preventDefault(),d()),"Control"==e.key&&d()})),document.addEventListener("keyup",(function(e){"Control"==e.key&&l()}));case 27:e.next=30;break;case 29:throw new Error("artifact element not found");case 30:case"end":return e.stop()}}),e)}))));var m={src:"/assets/img/avatars/FemaleCTarget.png",offset:{x:-115,y:-65}},v={src:"/assets/img/avatars/FemaleCExplain.png",offset:{x:0,y:0}};function b(e,t){return"node"===e.element_type?[e.element_id]:"edge"===e.element_type?t.getConnectedNodes(e.element_id):"missing_edge"==e.element_type?[e.source,e.target]:[]}function p(e,t,n,r){var o=b(e,t);if(o.length>0){var i=t.getPositions(o),a={x:0,y:0},s=0;for(var c in i)a.x+=i[c].x,a.y+=i[c].y,s++;return a.x/=s,a.y/=s,t.canvasToDOM(a)}var d=n.getBoundingClientRect(),l=r.getBoundingClientRect();return console.log({nwPos:d,fbPos:l}),{x:d.right-l.width,y:d.bottom-l.height}}function w(e,t,n,r,o){switch(e.element_type){case"edge":case"node":case"missing_edge":var i=y(t.querySelector(".hint-message")),a=g(n,document.body),s=window.pageYOffset,c={x:r.x+o.x+a.x,y:r.y+o.y+a.y-i.y-s};t.style.left=c.x+"px",t.style.top=c.y+"px";break;default:t.style.left=r.x+"px",t.style.top=r.y+"px"}}function x(e,t){if(e){var n=document.createElement("template");return n.innerHTML='<a href="#" class="btn btn-success btn-block">'.concat(e.message,"</a>"),n}}function k(e){switch(e.element_type){case"edge":case"node":case"missing_edge":return m.offset;default:return v.offset}}var C='<link rel="stylesheet" href="/assets/style/feedback.css">\n    \x3c!-- <div id="dot" style="position: absolute; background: red; width: 10px; height: 10px; border-radius: 5px"></div> --\x3e\n    <div id="hint-target" class="overlay">\n        <div class="hint-message">\n            <div id="dismiss-button"></div>\n            <div class="hint-message-text">This is a hint. Do you think it\'s any good?</div>\n            <span id="hint-id" class="hint-id tag"></span>\n            <div id="hint-buttons"></div>\n        </div>\n        <img class="hint-image" src=""/>\n    </div>',L='<div class="selector columns is-centered">\n    <div class="column is-narrow">\n        <button class="button is-info" id="buttonBefore" disabled>Before</button>\n        <button class="button is-info" id="buttonAfter">After</button>\n    </div></div>';
//# sourceMappingURL=index.js.map
